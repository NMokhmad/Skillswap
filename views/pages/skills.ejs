<%- include('../partials/header.ejs') %>
</head>

<body>
    <%- include('../partials/navbar.ejs') %>

    <div class="ss-sk-page">

        <!-- Header -->
        <header class="ss-sk-header">
            <h1 class="ss-sk-title">Nos <em>compétences</em></h1>
            <p class="ss-sk-subtitle">Découvrez toutes les compétences disponibles sur SkillSwap</p>
            <div class="ss-sk-stats">
                <div class="ss-sk-stat-box">
                    <span class="ss-sk-stat-num"><%= skills.length %></span>
                    <span class="ss-sk-stat-label">Compétences</span>
                </div>
                <div class="ss-sk-stat-box">
                    <span class="ss-sk-stat-num"><%= totalUsers %></span>
                    <span class="ss-sk-stat-label">Talents</span>
                </div>
            </div>
        </header>

        <!-- Body -->
        <div class="ss-sk-body">

            <!-- Search -->
            <div class="ss-sk-search-wrap">
                <i class="fas fa-search"></i>
                <input
                    class="ss-sk-search"
                    type="text"
                    id="skills-search"
                    placeholder="Rechercher une compétence..."
                    autocomplete="off"
                >
            </div>

            <!-- Grid -->
            <div class="ss-sk-grid">
                <% skills.forEach((skill) => { %>
                    <a href="/skills/<%= skill.slug %>" class="ss-sk-card-link">
                        <div class="ss-sk-card">

                            <!-- Badge -->
                            <div class="ss-sk-badge">
                                <i class="fas fa-users"></i>
                                <span><%= skill.users ? skill.users.length : 0 %></span>
                            </div>

                            <!-- Icon -->
                            <div class="ss-sk-icon-wrap">
                                <i class="fas <%= skill.icon %>"></i>
                            </div>

                            <!-- Label -->
                            <h2 class="ss-sk-label"><%= skill.label %></h2>

                            <!-- CTA -->
                            <span class="ss-sk-cta">Voir les talents →</span>

                        </div>
                    </a>
                <% }) %>
            </div>

            <!-- Bottom CTA -->
            <div class="ss-sk-bottom-cta">
                <p class="ss-sk-bottom-cta-title">Vous ne trouvez pas votre compétence ?</p>
                <p class="ss-sk-bottom-cta-text">Connectez-vous pour proposer de nouvelles compétences à notre catalogue.</p>
                <a href="/login" class="ss-sk-bottom-cta-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    Se connecter
                </a>
            </div>

        </div><!-- /.ss-sk-body -->

    </div><!-- /.ss-sk-page -->

    <script nonce="<%= cspNonce %>">
      const searchInput = document.getElementById('skills-search');
      const cards = document.querySelectorAll('.ss-sk-grid .ss-sk-card-link');

      searchInput.addEventListener('input', () => {
        const query = searchInput.value.toLowerCase().trim();
        cards.forEach(card => {
          const label = card.querySelector('.ss-sk-label');
          if (label) {
            card.style.display = label.textContent.toLowerCase().includes(query) ? '' : 'none';
          }
        });
      });
    </script>

    <%- include('../partials/footer.ejs') %>
</body>
</html>
